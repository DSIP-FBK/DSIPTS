
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>dsipts.data_structure package &#8212; DSIPTS  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dsipts.models package" href="dsipts.models.html" />
    <link rel="prev" title="dsipts.data_management package" href="dsipts.data_management.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="dsipts-data-structure-package">
<h1>dsipts.data_structure package<a class="headerlink" href="#dsipts-data-structure-package" title="Permalink to this headline">¶</a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</section>
<section id="module-dsipts.data_structure.data_structure">
<span id="dsipts-data-structure-data-structure-module"></span><h2>dsipts.data_structure.data_structure module<a class="headerlink" href="#module-dsipts.data_structure.data_structure" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.data_structure.data_structure.</span></span><span class="sig-name descname"><span class="pre">Categorical</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#dsipts.data_structure.utils.ActionEnum" title="dsipts.data_structure.utils.ActionEnum"><span class="pre">dsipts.data_structure.utils.ActionEnum</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">level</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#Categorical"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Create a categorical signal it can act as mutliplicative or additive. You can control the number of classesm the duration and the level</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.action">
<span class="sig-name descname"><span class="pre">action</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dsipts.data_structure.utils.ActionEnum" title="dsipts.data_structure.utils.ActionEnum"><span class="pre">dsipts.data_structure.utils.ActionEnum</span></a></em><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.action" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.classes">
<span class="sig-name descname"><span class="pre">classes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.classes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.duration">
<span class="sig-name descname"><span class="pre">duration</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.duration" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.frequency">
<span class="sig-name descname"><span class="pre">frequency</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.frequency" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.generate_signal">
<span class="sig-name descname"><span class="pre">generate_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#Categorical.generate_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.generate_signal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.level">
<span class="sig-name descname"><span class="pre">level</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.level" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#Categorical.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.plot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.Categorical.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#Categorical.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.Categorical.validate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.data_structure.data_structure.</span></span><span class="sig-name descname"><span class="pre">TimeSeries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for generating time series object. If you don’t have any time series you can build one fake timeseries using some
helping classes (Categorical for instance).</p>
<blockquote>
<div><dl class="simple">
<dt>name<span class="classifier">str</span></dt><dd><p>name of the series</p>
</dd>
</dl>
</div></blockquote>
<p>For example we can generate a toy timeseries:
#- add a multiplicative categorical feature (weekly)
&gt;&gt;&gt; settimana = Categorical(‘settimanale’,1,[1,1,1,1,1,1,1],7,’multiplicative’,[0.9,0.8,0.7,0.6,0.5,0.99,0.99])
#- an additive montly feature (here a year is composed by 5 months)
&gt;&gt;&gt; mese = Categorical(‘mensile’,1,[31,28,20,10,33],5,’additive’,[10,20,-10,20,0])
#- a spotted categorical variable that happens every 100 days and lasts 1 day
&gt;&gt;&gt; spot = Categorical(‘spot’,100,[7],1,’additive’,[10])
&gt;&gt;&gt; ts = TimeSeries(‘prova’)
&gt;&gt;&gt; ts.generate_signal(length = 5000,categorical_variables = [settimana,mese,spot],noise_mean=1,type=0) ##we can add also noise
&gt;&gt;&gt; ts.plot()</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.create_data_loader">
<span class="sig-name descname"><span class="pre">create_data_loader</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starting_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.create_data_loader"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.create_data_loader" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Create the dataset for the training/inference step</dt><dd><dl class="simple">
<dt>data<span class="classifier">pd.DataFrame</span></dt><dd><p>input dataset, usually a subset of self.data</p>
</dd>
<dt>past_steps<span class="classifier">int</span></dt><dd><p>past context length</p>
</dd>
<dt>future_steps<span class="classifier">int</span></dt><dd><p>future lags to predict</p>
</dd>
<dt>shift<span class="classifier">int</span></dt><dd><p>if &gt;0 the future input variables will be shifted (categorical and numerical). For example for attention model it is better to start with a know value of y and use it during the process</p>
</dd>
<dt>starting_point<span class="classifier">dict</span></dt><dd><p>a dictionary indicating if a sample must be considered. It is checked for the first lag in the future (useful in the case your model has to predict only starting from hour 12)</p>
</dd>
<dt>skip_step<span class="classifier">int</span></dt><dd><p>list of the categortial variables (same for past and future). Usual there is a skip of one between two saples but for debugging  or training time purposes you can skip some samples</p>
</dd>
</dl>
<dl class="simple">
<dt>dataset<span class="classifier">MyDataset</span></dt><dd><p>class thath extends torch.utils.data.Dataset (see utils)</p>
</dd>
<dt>keys of a batch:</dt><dd><p>y : the target variable(s)
x_num_past: the numerical past variables
x_num_future: the numerical future variables
x_cat_past: the categorical past variables
x_cat_future: the categorical future variables
idx_target: index of target features in the past array</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.generate_signal">
<span class="sig-name descname"><span class="pre">generate_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.generate_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.generate_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>This will generate a syntetic signal with a selected length, a noise level and some categorical variables. The additive series are added at the end while the multiplicative series axt</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.inference">
<span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.inference" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.inference_on_set">
<span class="sig-name descname"><span class="pre">inference_on_set</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'test'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rescaling</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.inference_on_set"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.inference_on_set" title="Permalink to this definition">¶</a></dt>
<dd><p>This function allows to get the prediction on a particular set (train, test or validation). TODO add inference on a custom dataset
batch_size, nu_worker controls the inference part, split params can be set to None if you want to use the same split procedure used in the training routine.
Set is one of train, test and validation. If rescaling is true the output will be rescaled to the initial values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_last</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dirpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a saved model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>models.Base</em>) – class of the model to load (it will be initiated by pytorch-lightening)</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – filename of the saved model</p></li>
<li><p><strong>load_last</strong> (<em>boolean</em>) – if true the last checkpoint will be loaded otherwise the best (in the validation set)</p></li>
<li><p><strong>dirpath</strong> (<em>None</em><em> or </em><em>str</em>) – if None we asssume that the model is loaded from the same pc where it has been trained, otherwise we can pass the dirpath where all the stuff has been saved</p></li>
<li><p><strong>weight_path</strong> (<em>None</em><em> or </em><em>str</em>) – if None the standard path will be used</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.load_signal">
<span class="sig-name descname"><span class="pre">load_signal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enrich_cat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cat_var</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">check_past</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.load_signal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.load_signal" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a crucial point in the data structure. We expect here to have a dataset with time as timestamp.
There are some checks:</p>
<blockquote>
<div><p>1- the duplicates will tbe removed taking the first instance
2- the frequency will the inferred taking the minumum time distance between samples
3- the dataset will be filled completing the missing timestamps</p>
</div></blockquote>
<dl class="simple">
<dt>data<span class="classifier">pd.DataFrame</span></dt><dd><p>input dataset the column indicating the time must be called <cite>time</cite></p>
</dd>
<dt>enrich_cat<span class="classifier">list</span></dt><dd><p>it is possible to let this function enrich the dataset for example adding the standard columns: hour, dow, month and minute</p>
</dd>
<dt>past_variables<span class="classifier">list</span></dt><dd><p>list of column names of past variables not available for future times</p>
</dd>
<dt>future_variables<span class="classifier">list</span></dt><dd><p>list of future variables available for tuture times</p>
</dd>
<dt>target_variables<span class="classifier">list</span></dt><dd><p>list of the target variables. They will added to past_variables by default unless <cite>check_past</cite> is false</p>
</dd>
<dt>cat_var<span class="classifier">list</span></dt><dd><p>list of the categortial variables (same for past and future)</p>
</dd>
<dt>check_past<span class="classifier">boolean</span></dt><dd><p>see <cite>target_variables</cite></p>
</dd>
</dl>
<p>None</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Easy way to control the loaded data</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.set_model">
<span class="sig-name descname"><span class="pre">set_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.set_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.set_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.split_for_train">
<span class="sig-name descname"><span class="pre">split_for_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">perc_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perc_valid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_validation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">range_test</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">past_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">future_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starting_point</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.split_for_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.split_for_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the data and create the datasets. The split can be done in percentage (perc_train, perc_valid) or passing periods (range_train, range_validation, range_test). The other parameters are related to
<cite>create_data_loader</cite> function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.data_structure.TimeSeries.train_model">
<span class="sig-name descname"><span class="pre">train_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dirpath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_epochs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auto_lr_find</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">devices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/data_structure.html#TimeSeries.train_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.data_structure.TimeSeries.train_model" title="Permalink to this definition">¶</a></dt>
<dd><dl>
<dt>Train the model</dt><dd><dl class="simple">
<dt>dirpath<span class="classifier">str</span></dt><dd><p>path where to put all the useful things</p>
</dd>
<dt>split_params<span class="classifier">dict</span></dt><dd><p>see <cite>split_for_train</cite></p>
</dd>
<dt>batch_size<span class="classifier">int</span></dt><dd><p>batch size</p>
</dd>
<dt>num_workers<span class="classifier">int</span></dt><dd><p>num_workers for the dataloader</p>
</dd>
<dt>max_epochs<span class="classifier">int</span></dt><dd><p>maximum epochs to perform</p>
</dd>
<dt>auto_lr_find<span class="classifier">boolean</span></dt><dd><p>find initial learning rate, see  <cite>pytorch-lightening</cite></p>
</dd>
<dt>devices<span class="classifier">str or [int]</span></dt><dd><p>devices to use. Use auto if cpu or the list of gpu to use otherwise</p>
</dd>
</dl>
<p>None (it stores all the think needed please save the model if you don’t want to lose all)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-dsipts.data_structure.utils">
<span id="dsipts-data-structure-utils-module"></span><h2>dsipts.data_structure.utils module<a class="headerlink" href="#module-dsipts.data_structure.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="dsipts.data_structure.utils.ActionEnum">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.data_structure.utils.</span></span><span class="sig-name descname"><span class="pre">ActionEnum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/utils.html#ActionEnum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.utils.ActionEnum" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>action of categorical variable</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.utils.ActionEnum.additive">
<span class="sig-name descname"><span class="pre">additive</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'additive'</span></em><a class="headerlink" href="#dsipts.data_structure.utils.ActionEnum.additive" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dsipts.data_structure.utils.ActionEnum.multiplicative">
<span class="sig-name descname"><span class="pre">multiplicative</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'multiplicative'</span></em><a class="headerlink" href="#dsipts.data_structure.utils.ActionEnum.multiplicative" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.data_structure.utils.MetricsCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.data_structure.utils.</span></span><span class="sig-name descname"><span class="pre">MetricsCallback</span></span><a class="reference internal" href="_modules/dsipts/data_structure/utils.html#MetricsCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.utils.MetricsCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pytorch_lightning.callbacks.callback.Callback</span></code></p>
<p>PyTorch Lightning metric callback.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.utils.MetricsCallback.on_train_end">
<span class="sig-name descname"><span class="pre">on_train_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/utils.html#MetricsCallback.on_train_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.utils.MetricsCallback.on_train_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the train ends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dsipts.data_structure.utils.MetricsCallback.on_validation_end">
<span class="sig-name descname"><span class="pre">on_validation_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/utils.html#MetricsCallback.on_validation_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.utils.MetricsCallback.on_validation_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called when the validation loop ends.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dsipts.data_structure.utils.MyDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dsipts.data_structure.utils.</span></span><span class="sig-name descname"><span class="pre">MyDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">idx_target</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/utils.html#MyDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.utils.MyDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.dataset.Dataset</span></code></p>
<p>Extension of Dataset class. While training the returned item is a batch containing the keys explained in the readme file</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dsipts.data_structure.utils.extend_df">
<span class="sig-prename descclassname"><span class="pre">dsipts.data_structure.utils.</span></span><span class="sig-name descname"><span class="pre">extend_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dsipts/data_structure/utils.html#extend_df"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dsipts.data_structure.utils.extend_df" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</section>
<section id="module-dsipts.data_structure">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-dsipts.data_structure" title="Permalink to this headline">¶</a></h2>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">DSIPTS</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">dsipts</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="dsipts.html">dsipts package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="modules.html">dsipts</a><ul>
  <li><a href="dsipts.html">dsipts package</a><ul>
      <li>Previous: <a href="dsipts.data_management.html" title="previous chapter">dsipts.data_management package</a></li>
      <li>Next: <a href="dsipts.models.html" title="next chapter">dsipts.models package</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Andrea Gobbi.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.5.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/dsipts.data_structure.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>